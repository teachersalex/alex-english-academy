<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° Lightning Quiz Hub - Teacher Alex Academy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body class="sophisticated-bg min-h-screen">

    <!-- Professional Header Bar (EXACT COPY from hub.html) -->
    <header class="lesson-header-bar">
        <div class="header-left">
            <div class="brand-line">Teacher Alex English Academy</div>
            <div class="user-course-line" id="userCourseLine">Alex12345 ‚Ä¢ ‚ö° Lightning Quiz Hub</div>
        </div>
        
        <div class="header-actions">
            <button class="btn-portal" onclick="window.location.href='../student/portal.html'">‚Üê Portal</button>
            <button class="btn-sair" onclick="logout()">Sair</button>
        </div>
    </header>

    <!-- Main Content (SAME STRUCTURE as hub.html) -->
    <main class="lesson-content">
        <div class="max-w-6xl mx-auto px-4 pb-8">
        
            <!-- Lightning Quiz Header with Brazilian Touch -->
            <div class="elegant-card rounded-lg p-6 mb-6 bg-gradient-to-br from-yellow-500 via-orange-500 to-red-600 text-white">
                <div class="text-center">
                    <div class="text-6xl mb-4">‚ö°</div>
                    <h1 class="text-3xl font-bold mb-3">‚ö° Lightning Quiz Hub</h1>
                    <p class="text-yellow-100 text-lg mb-4">üß† 10 temas viciantes ‚Ä¢ 15 segundos por pergunta ‚Ä¢ True/False apenas!</p>
                    <div class="bg-white/20 backdrop-blur-sm rounded-lg p-4 border border-white/30">
                        <p class="text-white font-semibold text-base sm:text-lg">üéØ 100 atividades ultra-r√°pidas para testar seu ingl√™s</p>
                    </div>
                </div>
            </div>

            <!-- Clean XP Progress Bar (EXACT COPY from hub.html) -->
            <div class="elegant-card rounded-lg p-4 sm:p-6 mb-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-100">
                <div class="text-center">
                    <!-- User Info Line (EXACT COPY) -->
                    <div class="flex items-center justify-center space-x-4 text-sm sm:text-base text-charcoal mb-3">
                        <span class="font-semibold" id="userDisplayName">Estudante</span>
                        <span class="text-light-gray">‚Ä¢</span>
                        <span class="font-medium text-blue-600" id="currentLevelDisplay">N√≠vel 1</span>
                        <span class="text-light-gray">‚Ä¢</span>
                        <span class="font-medium text-purple-600" id="currentXPDisplay">0 XP</span>
                    </div>
                    
                    <!-- XP Progress Bar (EXACT COPY) -->
                    <div class="max-w-md mx-auto">
                        <div class="flex justify-between text-xs sm:text-sm text-medium-gray mb-2">
                            <span>Seu Progresso</span>
                            <span id="xpProgressText">0 / 100 XP</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3 sm:h-4">
                            <div id="xpProgressBar" 
                                 class="bg-gradient-to-r from-blue-500 to-purple-600 h-3 sm:h-4 rounded-full transition-all duration-700 shadow-sm" 
                                 style="width: 0%;">
                                <div class="h-full w-full rounded-full bg-gradient-to-r from-white/20 to-transparent"></div>
                            </div>
                        </div>
                        <p class="text-xs sm:text-sm text-medium-gray mt-2" id="nextLevelText">Pr√≥ximo N√≠vel: 100 XP</p>
                    </div>
                    
                    <!-- Back to Audio Lessons Link -->
                    <div class="mt-4">
                        <a href="../student/hub.html" class="btn-secondary w-full sm:w-auto inline-block text-center font-semibold py-3 px-6 rounded-lg text-sm sm:text-base no-underline">
                            üéß Voltar para Audio Lessons
                        </a>
                    </div>
                </div>
            </div>

            <!-- Lightning Quiz Themes - 10 themes with 10 activities each -->

            <!-- Theme 1: Digital Life & Gaming -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 1</span>
                    üéÆ Digital Life & Gaming
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-purple-600 to-blue-600 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('digital-gaming')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üéÆ Digital Life & Gaming</h3>
                            <p class="text-purple-100 text-lg mb-4">Social media, online world, gaming culture vocabulary</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="digital-progress">0/5 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="digital-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-purple-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° QUIZ R√ÅPIDO
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üéÆ</div>
                    </div>
                </div>
            </div>

            <!-- Theme 2: Music & Entertainment -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-pink-100 text-pink-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 2</span>
                    üéµ Music & Entertainment
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-pink-500 to-purple-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('music-entertainment')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üéµ Music & Entertainment</h3>
                            <p class="text-pink-100 text-lg mb-4">Brazilian music, international artists, concerts and shows</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="music-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="music-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-pink-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üéµ</div>
                    </div>
                </div>
            </div>

            <!-- Theme 3: Love & Dating -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 3</span>
                    üíï Love & Dating
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-red-500 to-pink-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('love-dating')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üíï Love & Dating</h3>
                            <p class="text-red-100 text-lg mb-4">Relationships, dating apps, romantic expressions</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="love-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="love-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-red-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üíï</div>
                    </div>
                </div>
            </div>

            <!-- Theme 4: Home & Living -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 4</span>
                    üè† Home & Living
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-green-500 to-teal-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('home-living')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üè† Home & Living</h3>
                            <p class="text-green-100 text-lg mb-4">Apartments, furniture, household life and decoration</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="home-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="home-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-green-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üè†</div>
                    </div>
                </div>
            </div>

            <!-- Theme 5: Transportation & City Life -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 5</span>
                    üöó Transportation & City Life
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-blue-500 to-indigo-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('transport-city')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üöó Transportation & City Life</h3>
                            <p class="text-blue-100 text-lg mb-4">Traffic, Uber, public transport, S√£o Paulo city life</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="transport-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="transport-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-blue-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üöó</div>
                    </div>
                </div>
            </div>

            <!-- Theme 6: Money & Success -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 6</span>
                    üí∞ Money & Success
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-yellow-500 to-orange-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('money-success')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üí∞ Money & Success</h3>
                            <p class="text-yellow-100 text-lg mb-4">Banking, investments, financial goals, entrepreneurship</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="money-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="money-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-yellow-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üí∞</div>
                    </div>
                </div>
            </div>

            <!-- Theme 7: Learning & Growth -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 7</span>
                    üéì Learning & Growth
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-indigo-500 to-purple-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('learning-growth')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üéì Learning & Growth</h3>
                            <p class="text-indigo-100 text-lg mb-4">Education, courses, personal development, English goals</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="learning-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="learning-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-indigo-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üéì</div>
                    </div>
                </div>
            </div>

            <!-- Theme 8: Brazil vs World -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 8</span>
                    üåç Brazil vs World
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-green-600 to-blue-600 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('brazil-world')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üåç Brazil vs World</h3>
                            <p class="text-green-100 text-lg mb-4">Cultural differences, travel dreams, global perspective</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="brazil-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="brazil-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-green-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üåç</div>
                    </div>
                </div>
            </div>

            <!-- Theme 9: Sports & Passion -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 9</span>
                    ‚öΩ Sports & Passion
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-orange-500 to-red-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('sports-passion')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">‚öΩ Sports & Passion</h3>
                            <p class="text-orange-100 text-lg mb-4">Football, Olympics, Brazilian sports culture and passion</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="sports-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="sports-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-orange-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">‚öΩ</div>
                    </div>
                </div>
            </div>

            <!-- Theme 10: Future & Technology -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-cyan-100 text-cyan-800 px-3 py-1 rounded-full text-sm font-semibold mr-3">TEMA 10</span>
                    üîÆ Future & Technology
                </h2>
                <div class="elegant-card rounded-lg p-6 bg-gradient-to-r from-cyan-500 to-blue-500 text-white cursor-pointer hover:scale-105 transition-all shadow-lg" onclick="navigateToQuiz('future-tech')">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-3">üîÆ Future & Technology</h3>
                            <p class="text-cyan-100 text-lg mb-4">AI, careers, dreams, what's coming next in our world</p>
                            <div class="bg-white/20 rounded-lg p-3 mb-4">
                                <div class="flex justify-between text-sm mb-2 text-white font-medium">
                                    <span>Progresso</span>
                                    <span id="future-progress">0/10 completas</span>
                                </div>
                                <div class="w-full bg-white/30 rounded-full h-3">
                                    <div id="future-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="bg-white text-cyan-600 px-6 py-3 rounded-lg text-base font-bold inline-block">
                                ‚ö° EM BREVE
                            </div>
                        </div>
                        <div class="ml-6 text-5xl">üîÆ</div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Firebase SDK (SAME as hub.html) -->
    <script type="module" src="../js/firebase.js"></script>

    <!-- Lightning Quiz Hub Logic (EXACT PATTERNS from hub.html) -->
    <script type="module">
        import { db } from '../js/firebase.js';
        import { doc, getDoc } from 'https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js';

        // Check auth (EXACT COPY from hub.html)
        function checkAuth() {
            if (!localStorage.getItem('studentLoggedIn')) {
                window.location.href = '../index.html';
                return false;
            }
            return true;
        }

        function getCurrentStudent() {
            const authData = localStorage.getItem('studentAuth');
            return authData ? JSON.parse(authData) : null;
        }

        // Level calculation functions (EXACT COPY from hub.html)
        function calculateLevelFromXP(totalXP) {
            if (totalXP < 100) return 1;
            
            // Exponential scaling: Level 2 = 100 XP, Level 3 = 250 XP, etc.
            let level = 1;
            let xpRequired = 0;
            
            while (totalXP >= xpRequired) {
                level++;
                xpRequired += (level - 1) * 150; // Exponential increase
                if (level > 1000) break;
            }
            
            return Math.min(level - 1, 1000);
        }

        function getXPForNextLevel(currentLevel) {
            if (currentLevel >= 1000) return 0;
            
            let totalXPNeeded = 0;
            for (let i = 2; i <= currentLevel + 1; i++) {
                totalXPNeeded += (i - 1) * 150;
            }
            return totalXPNeeded;
        }

        function getXPForCurrentLevel(currentLevel) {
            if (currentLevel <= 1) return 0;
            
            let totalXPNeeded = 0;
            for (let i = 2; i <= currentLevel; i++) {
                totalXPNeeded += (i - 1) * 150;
            }
            return totalXPNeeded;
        }

        // Navigation function - LIVE LIGHTNING QUIZ SYSTEM
        window.navigateToQuiz = function(quizTheme) {
            // Digital Life & Gaming is LIVE!
            if (quizTheme === 'digital-gaming') {
                window.location.href = 'lightning-digital-gaming.html';
                return;
            }
            
            // Other themes coming soon
            alert(`üöß ${quizTheme} quiz em desenvolvimento!\n\n‚ö° Digital Life & Gaming j√° est√° pronto!\n\nüéÆ Clique no primeiro tema para testar o sistema Lightning Quiz!`);
        };

        // Logout function (EXACT COPY from hub.html)
        window.logout = function() {
            localStorage.clear();
            window.location.href = '../index.html';
        };

        // Load progress - COMPLETE Lightning Quiz Progress + XP Progress Loading
        async function loadQuizProgress() {
            try {
                const currentStudent = getCurrentStudent();
                if (!currentStudent) return;

                // Update header with Brazilian touch (SAME as hub.html)
                const displayName = currentStudent.displayName || 'Estudante';
                document.getElementById('userCourseLine').textContent = `${displayName} ‚Ä¢ ‚ö° Lightning Quiz Hub`;

                // SAFE: Load student data including XP progress from Firebase
                const { doc, getDoc } = await import('https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js');
                const studentRef = doc(db, 'students', currentStudent.username);
                const studentDoc = await getDoc(studentRef);
                
                if (studentDoc.exists()) {
                    const studentData = studentDoc.data();
                    
                    // UPDATE XP PROGRESS BAR (EXACT COPY from hub.html logic)
                    const totalXP = studentData.totalXP || 0;
                    const currentLevel = calculateLevelFromXP(totalXP);
                    const currentLevelXP = getXPForCurrentLevel(currentLevel);
                    const nextLevelXP = getXPForNextLevel(currentLevel);
                    const progressInLevel = totalXP - currentLevelXP;
                    const xpNeededForNextLevel = nextLevelXP - currentLevelXP;
                    const progressPercentage = xpNeededForNextLevel > 0 ? (progressInLevel / xpNeededForNextLevel) * 100 : 100;

                    // Update XP progress bar with Brazilian Portuguese (EXACT COPY)
                    document.getElementById('userDisplayName').textContent = displayName;
                    document.getElementById('currentLevelDisplay').textContent = `N√≠vel ${currentLevel}`;
                    document.getElementById('currentXPDisplay').textContent = `${totalXP.toLocaleString('pt-BR')} XP`;
                    document.getElementById('xpProgressText').textContent = `${progressInLevel} / ${xpNeededForNextLevel} XP`;
                    document.getElementById('xpProgressBar').style.width = `${Math.min(progressPercentage, 100)}%`;
                    
                    if (currentLevel >= 1000) {
                        document.getElementById('nextLevelText').textContent = 'üèÜ N√≠vel M√°ximo Alcan√ßado!';
                    } else {
                        document.getElementById('nextLevelText').textContent = `Pr√≥ximo N√≠vel: ${nextLevelXP.toLocaleString('pt-BR')} XP`;
                    }
                    
                    // Load Lightning Quiz progress if available
                    const lightningQuizzes = studentData.lightningQuizzes || {};
                    
                    // Update Digital Gaming progress if available
                    const digitalGaming = lightningQuizzes.digitalGaming || {};
                    const completedQuizzes = Object.keys(digitalGaming).length;
                    const totalQuizzes = 5; // 5 quizzes in Digital Gaming theme
                    const progressPercentage2 = (completedQuizzes / totalQuizzes) * 100;
                    
                    // Update progress display for Digital Gaming theme
                    const digitalProgress = document.getElementById('digital-progress');
                    const digitalBar = document.getElementById('digital-bar');
                    
                    if (digitalProgress && digitalBar) {
                        digitalProgress.textContent = `${completedQuizzes}/5 completas`;
                        digitalBar.style.width = `${progressPercentage2}%`;
                    }
                    
                    console.log(`‚úÖ Lightning Quiz Hub loaded with REAL XP progress:`);
                    console.log(`   ‚Üí Level: ${currentLevel}`);
                    console.log(`   ‚Üí XP: ${totalXP.toLocaleString('pt-BR')}`);
                    console.log(`   ‚Üí Progress: ${progressInLevel}/${xpNeededForNextLevel} XP`);
                    console.log(`   ‚Üí Lightning Quizzes: ${completedQuizzes}/5 Digital Gaming completed`);
                    
                } else {
                    console.log('‚ö° No student data found - using defaults');
                    // Set defaults
                    document.getElementById('userDisplayName').textContent = displayName;
                    document.getElementById('currentLevelDisplay').textContent = 'N√≠vel 1';
                    document.getElementById('currentXPDisplay').textContent = '0 XP';
                    document.getElementById('xpProgressText').textContent = '0 / 100 XP';
                    document.getElementById('xpProgressBar').style.width = '0%';
                    document.getElementById('nextLevelText').textContent = 'Pr√≥ximo N√≠vel: 100 XP';
                }

            } catch (error) {
                console.error('‚ùå Error loading quiz progress:', error);
                // SAFE: Fail silently - never break student experience
                const currentStudent = getCurrentStudent();
                const displayName = currentStudent ? currentStudent.displayName : 'Estudante';
                document.getElementById('userDisplayName').textContent = displayName;
            }
        }

        // Initialize (EXACT PATTERN from hub.html)
        document.addEventListener('DOMContentLoaded', () => {
            if (!checkAuth()) return;
            loadQuizProgress();
            console.log('‚ö° Lightning Quiz Hub initialized with FULL XP tracking - 10 themes ready!');
        });
    </script>

    <!-- Header Bar Styles (EXACT COPY from hub.html) -->
    <style>
        /* Professional Header Bar */
        .lesson-header-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
            background: white;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            padding: 16px 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .header-left {
            text-align: center;
        }

        .brand-line {
            font-size: 12px;
            font-weight: 600;
            color: #3b82f6;
            text-align: center;
            letter-spacing: 0.5px;
        }

        .user-course-line {
            font-size: 14px;
            color: #1f2937;
            font-weight: 500;
            text-align: center;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .btn-portal {
            background: #3b82f6;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
        }

        .btn-portal:hover {
            background: #2563eb;
        }

        .btn-sair {
            background: transparent;
            color: #6b7280;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-sair:hover {
            background: #f9fafb;
            color: #374151;
        }

        .lesson-content {
            margin-top: 120px;
        }

        /* Button Styles */
        .btn-secondary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            text-decoration: none;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            text-decoration: none;
        }

        /* Typography */
        .text-charcoal { color: #1f2937; }
        .text-medium-gray { color: #6b7280; }
        .text-light-gray { color: #e5e7eb; }

        /* Desktop responsive */
        @media (min-width: 768px) {
            .lesson-header-bar {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 12px 40px;
            }
            
            .header-left {
                text-align: left;
            }
            
            .lesson-content {
                margin-top: 80px;
            }
        }

        /* Mobile adjustments */
        @media (max-width: 480px) {
            .lesson-header-bar {
                padding: 12px 16px;
                gap: 6px;
            }
            
            .brand-line {
                font-size: 11px;
            }
            
            .user-course-line {
                font-size: 13px;
            }
            
            .btn-portal, .btn-sair {
                padding: 6px 12px;
                font-size: 11px;
            }
            
            .lesson-content {
                margin-top: 110px;
            }
        }
    </style>

</body>
</html>
